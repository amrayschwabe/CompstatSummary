\section{Model Selection}
\textbf{criteria: } Mallow's $C_p$, AIC, BIC = $2-ln(\hat L) + d*log(n)$, Adjusted $R^2$
\textbf{ridge regression: } $\hat\beta^{ridge} = argmin ||y-XB||_2^2+ \lambda||B||_2^2$. If you draw that, circle around zero. 
\textcolor{blue}{data(Hitters)
Hitters=na.omit(Hitters)
x = model.matrix(Salary\textasciitilde.,  data=Hitters)
x = x[,-1] remove first column (intercept)
y = Hitters\$Salary
grid=10\^seq(from = 10, to = -2, length=100)
ridge.mod = glmnet(x,y,alpha=0,lambda=grid)  }
\textbf{lasso regression: }
$\hat\beta^{lasso} = argmin ||y-XB||_2^2+ \lambda||B||_1^2$. If you draw that, diamond around zero -> will set values to zero. 
\textcolor{blue}{lasso.mod = glmnet(x[train,], y[train], alpha=1, 
                   lambda=grid, thresh=1e-12)}

\textbf{best subset: }
1)$M_0$ null model (only sample mean)
2) fit $p \choose k$ models with k pred. and select best $M_k$
3) select best among $M_0 ... M_p$
\textcolor{blue}{regfit.full=regsubsets(Salary\textasciitilde., data=Hitters,nvmax=19)}

\textbf{forward stepwise: }
1)$M_0$ null model (only sample mean)
2) fit p-k models that add 1 pred and select best $M_k$
3) select best among $M_0 ... M_p$
\textcolor{blue}{regfit.fwd=regsubsets(Salary\textasciitilde., data=Hitters,nvmax=19,method="forward")}

\textbf{backward stepwise: }
1) $M_p$ full model
2) k = p, p-1, ...1,
k models with 1 pred less, choose best $M_{k-1}$
3) select best $M_0 ... M_p$
\textcolor{blue}{regfit.bwd=regsubsets(Salary\textasciitilde., data=Hitters,nvmax=19,method="backward")}

\textbf{Choose amongst models: } \textcolor{blue}{train=sample (c(TRUE,FALSE), nrow(Hitters),replace=TRUE) test=(!train)
regfit.best = regsubsets(Salary\textasciitilde., data=Hitters[train,],nvmax=19)
 \textcolor{gray}{compute mean squared error on test set}
test.mat = model.matrix(Salary\textasciitilde., data=Hitters[test,])
val.errors = rep(NA,19)
for(i in 1:19){
  coefi = coef(regfit.best,id=i)
  pred = test.mat[,names(coefi)]\%*\%coefi
  val.errors[i] = mean((Hitters\$Salary[test]-pred)\^{}2)
}
 \textcolor{gray}{refit model with 10 variables on full data to obtain our final best model}
regfit.best=regsubsets(Salary\textasciitilde., data=Hitters,nvmax=19)
coef(regfit.best, which.min(val.errors))
}